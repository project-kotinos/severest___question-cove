<div class="container-fluid">
  <div class="row">
    <div class="col-md-8 col-md-offset-2">

      <div class="row">
        <div class="col-sm-1 text-center vote-count">
          <div>
            <%= voteup questionup_path(@question) %>
          </div>
          <div>
            <strong><%= @question.total_votes %></strong>
          </div>
          <div>
            <%= votedown questiondown_path(@question) %>
          </div>

          <% if can_edit_question %>
            <div>
              <a href="<%= edit_question_url(@question) %>">
                <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
              </a>
            </div>
            <div>
              <%= link_to @question, method: :delete, data: { confirm: 'Are you sure?' } do %>
                <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
              <% end %>
            </div>
          <% end %>
        </div>

        <div class="col-sm-11">
          <div id="question-text">
            <%= sanitize @question.render_question %>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-md-7 col-md-offset-1">
          <%= render partial: 'shared/tag_list', locals: {tags: @question.tag_list} %>
        </div>
        <%= render partial: 'shared/question_user_meta', locals: {obj: @question, offset: nil} %>
      </div>

      <div class="row">
        <div class="col-md-7 col-md-offset-1">
          <%= render partial: 'comments/list', locals: {obj: @question} %>
        </div>
      </div>


      <% @question.sorted_answers.each do |answer| %>
        <div class="row">
          <div class="col-sm-1 text-center vote-count">
            <div>
              <%= voteup answerup_path(answer) %>
            </div>
            <div>
              <strong><%= answer.total_votes %></strong>
            </div>
            <div>
              <%= votedown answerdown_path(answer) %>
            </div>

            <% if answer.user == current_user %>
              <div>
                <a href="<%= edit_answer_url(answer) %>">
                  <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                </a>
              </div>
              <div>
                <%= link_to answer, method: :delete, data: { confirm: 'Are you sure?' } do %>
                  <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                <% end %>
              </div>
            <% end %>

            <% if can_edit_question && (@question.best_answer.nil? || @question.best_answer.id != answer.id) %>
              <div>
                <%= form_tag(best_answer_path(@question.id), method: "post") do %>
                  <input type="hidden" name="answer_id" value="<%= answer.id %>"/>
                  <button class="btn btn-link" type="submit"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span></button>
                <% end %>
              </div>
            <% end %>
          </div>
          <div class="col-sm-10">
            <% if !@question.best_answer.nil? && @question.best_answer.id == answer.id %>
              <div class="best-answer">
                <span class="glyphicon glyphicon-ok" aria-hidden="true"></span> Best!
              </div>
            <% end %>
            <p><%= sanitize answer.render_answer %></p>
          </div>
        </div>

        <div class="row">
          <%= render partial: 'shared/answer_user_meta', locals: {obj: answer, offset: 8} %>
        </div>

        <div class="row">
          <div class="col-md-7 col-md-offset-1">
            <%= render partial: 'comments/list', locals: {obj: answer} %>
          </div>
        </div>

        <hr/>
      <% end %>

      <h4>Your answer</h4>
      <%= render 'answers/form' %>

    </div>
  </div>
</div>
